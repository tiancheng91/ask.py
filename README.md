# ask.py

[![PyPI version](https://badge.fury.io/py/ask-py-cli.svg)](https://badge.fury.io/py/ask-py-cli)
[![Python 3.10+](https://img.shields.io/badge/python-3.10+-blue.svg)](https://www.python.org/downloads/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

[English](README_EN.md) | ç®€ä½“ä¸­æ–‡ | [æ—¥æœ¬èª](README_JA.md)

ç»ˆç«¯ LLM é—®ç­”å·¥å…·ï¼Œæ”¯æŒå¤šæ¨¡å‹ã€è§’è‰²è®°å¿†å’Œ MCP å·¥å…·è°ƒç”¨ã€‚

## ä¸ºä»€ä¹ˆé€‰æ‹© ask.py

ç›¸æ¯”ä¼ ç»Ÿçš„ AI Agent æ¡†æ¶ï¼Œ`ask.py` ä¸“æ³¨äº**è½»é‡ã€å¿«é€Ÿã€ç»ˆç«¯å‹å¥½**çš„è®¾è®¡ï¼š

- **æè‡´çš„è½»é‡**ï¼šæ— éœ€å¤æ‚çš„ Agent æ¡†æ¶ï¼Œèµ„æºå ç”¨ä½ï¼Œå¿«é€Ÿå“åº”
- **ç»ˆç«¯ä¼˜å…ˆ**ï¼š`ask "é—®é¢˜"` å³å¯è·å¾—ç­”æ¡ˆï¼Œæµå¼è¾“å‡ºï¼Œå®Œç¾èå…¥ç»ˆç«¯å·¥ä½œæµ
- **ä¸“æ³¨æ ¸å¿ƒåœºæ™¯**ï¼šé€‚åˆæ—¥å¸¸å¼€å‘ä¸­çš„å¿«é€ŸæŸ¥è¯¢ã€ä»£ç åˆ†æã€é”™è¯¯è¯Šæ–­

æ— éœ€å¯åŠ¨é‡å‹ Agent æ¡†æ¶ï¼Œå³å¯äº«å—è½»é‡çº§çš„ AI é—®ç­”ä½“éªŒã€‚

## ç‰¹æ€§

- ğŸš€ å¿«é€Ÿç»ˆç«¯é—®ç­”ï¼Œç›´æ¥ `ask "é—®é¢˜"` å³å¯
- âš¡ æµå¼è¾“å‡ºï¼Œå®æ—¶æ˜¾ç¤ºå›ç­”ï¼ˆé»˜è®¤å¯ç”¨ï¼‰
- ğŸ”§ å¤šæ¨¡å‹é…ç½®ï¼Œæ”¯æŒä»»æ„ OpenAI å…¼å®¹æ¥å£
- ğŸ­ è§’è‰²ç³»ç»Ÿï¼Œè‡ªå®šä¹‰ System Prompt
- ğŸ§  ä¸‰å±‚è®°å¿†ç³»ç»Ÿï¼ˆçŸ­æœŸ/ä¸­æœŸ/é•¿æœŸï¼‰ï¼Œè‡ªåŠ¨å‹ç¼©æ·˜æ±°
- ğŸ”Œ MCPï¼ˆModel Context Protocolï¼‰å·¥å…·æ”¯æŒ
- ğŸ“ æ–‡ä»¶å†…å®¹åˆ†æï¼Œæ”¯æŒ `-f` å‚æ•°è¯»å–æ–‡ä»¶
- ğŸ“Š é”™è¯¯æ—¥å¿—åˆ†æï¼Œæ”¯æŒä» stdin è¯»å–
- ğŸŒ ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼Œè‡ªåŠ¨æ³¨å…¥å·¥ä½œç›®å½•ã€ç¯å¢ƒå˜é‡ç­‰

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…

```bash
# ä½¿ç”¨ pipxï¼ˆæ¨èï¼‰
pipx install ask-py-cli

# æˆ–ä½¿ç”¨ uv tool
uv tool install ask-py-cli
```

### 2. å¼€å§‹ä½¿ç”¨

å®‰è£…åå³å¯ç›´æ¥ä½¿ç”¨ï¼Œé¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®ï¼š

```bash
# ç›´æ¥æé—®ï¼ˆä½¿ç”¨é»˜è®¤çš„ public æ¨¡å‹ï¼‰
ask "ä»€ä¹ˆæ˜¯ Pythonï¼Ÿ"
```

> âš ï¸ **é‡è¦æç¤º**: 
> - é»˜è®¤çš„ `public(glm-4-flash)` æ¨¡å‹ä»…ç”¨äº**å¿«é€Ÿä½“éªŒ**ï¼Œæœ‰ **IP ç»´åº¦é¢‘æ¬¡é™åˆ¶**ï¼ˆåŠ¨æ€è°ƒæ•´ï¼‰
> - **é•¿æœŸä½¿ç”¨å»ºè®®é…ç½®è‡ªå·±çš„ API å¯†é’¥**ï¼Œé¿å…é¢‘æ¬¡é™åˆ¶å½±å“ä½¿ç”¨
> - æ”¯æŒä»»ä½• OpenAI å…¼å®¹æ¥å£ï¼šOpenAIã€Azure OpenAIã€DeepSeekã€æ™ºè°± GLMã€Ollama ç­‰

#### æ·»åŠ è‡ªå·±çš„æ¨¡å‹

```bash
ask model add openai \
    -b https://api.openai.com/v1 \
    -k $OPENAI_API_KEY \
    -m gpt-4 \
    --set-default
```

### 3. å¼€å§‹ä½¿ç”¨

```bash
# åŸºç¡€é—®ç­”ï¼ˆé»˜è®¤æµå¼è¾“å‡ºï¼Œå®æ—¶æ˜¾ç¤ºï¼‰
ask "ä»€ä¹ˆæ˜¯é‡å­è®¡ç®—ï¼Ÿ"
ask "è§£é‡Š Python çš„è£…é¥°å™¨"

# åˆ†æä»£ç æ–‡ä»¶
ask -f main.py "è§£é‡Šè¿™ä¸ªæ–‡ä»¶çš„åŠŸèƒ½"
ask "ä¼˜åŒ–è¿™æ®µä»£ç " -f utils.py
ask -f config.yaml "æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®"

# åˆ†æé”™è¯¯å’Œæ—¥å¿—
cat error.log | ask "åˆ†æè¿™ä¸ªé”™è¯¯" --stdin
python script.py 2>&1 | ask "è§£é‡Šè¿™ä¸ªé”™è¯¯" --stdin
tail -n 100 app.log | ask "æ‰¾å‡ºæ€§èƒ½é—®é¢˜" --stdin

# ä½¿ç”¨è§’è‰²ï¼ˆå¸¦è®°å¿†åŠŸèƒ½ï¼‰
ask role add shell -s "ä½ æ˜¯ä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜åŠ©æ‰‹ã€‚å½“ç”¨æˆ·è¯¢é—®ç³»ç»Ÿç›¸å…³é—®é¢˜ï¼ˆå¦‚æ–‡ä»¶æ“ä½œã€è¿›ç¨‹ç®¡ç†ã€ç³»ç»Ÿä¿¡æ¯æŸ¥è¯¢ç­‰ï¼‰æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ shell å‘½ä»¤è§£å†³ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä»£ç å®ç°ã€‚" --set-default
ask "åˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰å¤§äº 100MB çš„æ–‡ä»¶"
ask "æ‰¾å‡ºå ç”¨ CPU æœ€é«˜çš„è¿›ç¨‹"  # è‡ªåŠ¨è®°å¿†ä¸Šä¸‹æ–‡ï¼Œæ— éœ€é‡å¤è¯´æ˜

# ä½¿ç”¨å·¥å…·æ¨¡å¼
ask -t "ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ"  # ä½¿ç”¨ time å·¥å…·
ask --mcp shell "åˆ—å‡ºå½“å‰ç›®å½•çš„ Python æ–‡ä»¶"  # ä½¿ç”¨ shell å·¥å…·

# ç»„åˆä½¿ç”¨
ask -r shell -f script.sh "ä¼˜åŒ–è¿™ä¸ªè„šæœ¬"
ask -f main.py "æ·»åŠ é”™è¯¯å¤„ç†" --no-stream  # ç¦ç”¨æµå¼è¾“å‡º
```

## å‘½ä»¤å‚è€ƒ

### æé—®

```bash
ask [OPTIONS] "é—®é¢˜"

é€‰é¡¹:
  -m, --model TEXT   æŒ‡å®šæ¨¡å‹
  -s, --system TEXT  ä¸´æ—¶ç³»ç»Ÿæç¤ºè¯
  -r, --role TEXT    ä½¿ç”¨æŒ‡å®šè§’è‰²
  -t, --tools        å¯ç”¨ MCP å·¥å…·
  --mcp NAME         æŒ‡å®š MCP æœåŠ¡å™¨ï¼ˆå¯å¤šæ¬¡ä½¿ç”¨ï¼‰
  --no-stream        ç¦ç”¨æµå¼è¾“å‡ºï¼ˆä¸€æ¬¡æ€§æ˜¾ç¤ºå®Œæ•´ç»“æœï¼‰
  -f, --file TEXT    è¯»å–æ–‡ä»¶å†…å®¹å¹¶åˆ†æ
  --stdin            ä»æ ‡å‡†è¾“å…¥è¯»å–å†…å®¹ï¼ˆç”¨äºé”™è¯¯åˆ†æç­‰ï¼‰
```

### ä½¿ç”¨ç¤ºä¾‹

#### æ—¥å¸¸é—®ç­”
```bash
# å¿«é€Ÿæé—®ï¼ˆæµå¼è¾“å‡ºï¼Œå®æ—¶æ˜¾ç¤ºï¼‰
ask "ä»€ä¹ˆæ˜¯ Python çš„ç”Ÿæˆå™¨ï¼Ÿ"
ask "è§£é‡Š RESTful API è®¾è®¡åŸåˆ™"
```

#### ä»£ç åˆ†æ
```bash
# åˆ†æå•ä¸ªæ–‡ä»¶
ask -f main.py "è§£é‡Šè¿™ä¸ªæ–‡ä»¶çš„åŠŸèƒ½"
ask "ä¼˜åŒ–è¿™æ®µä»£ç çš„æ€§èƒ½" -f utils.py

# åˆ†æé…ç½®æ–‡ä»¶
ask -f docker-compose.yml "æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®"
ask -f package.json "è§£é‡Šä¾èµ–å…³ç³»"
```

#### é”™è¯¯è¯Šæ–­
```bash
# åˆ†æé”™è¯¯æ—¥å¿—
cat error.log | ask "åˆ†æè¿™ä¸ªé”™è¯¯" --stdin
python script.py 2>&1 | ask "è§£é‡Šè¿™ä¸ªé”™è¯¯" --stdin

# åˆ†æåº”ç”¨æ—¥å¿—
tail -n 100 app.log | ask "æ‰¾å‡ºæ€§èƒ½ç“¶é¢ˆ" --stdin
journalctl -u myapp -n 50 | ask "åˆ†ææœåŠ¡é—®é¢˜" --stdin
```

#### ç³»ç»Ÿç®¡ç†è¾…åŠ©
```bash
# ä½¿ç”¨ shell è§’è‰²è¿›è¡Œç³»ç»Ÿç®¡ç†å¯¹è¯
ask role add shell -s "ä½ æ˜¯ä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜åŠ©æ‰‹ã€‚å½“ç”¨æˆ·è¯¢é—®ç³»ç»Ÿç›¸å…³é—®é¢˜ï¼ˆå¦‚æ–‡ä»¶æ“ä½œã€è¿›ç¨‹ç®¡ç†ã€ç³»ç»Ÿä¿¡æ¯æŸ¥è¯¢ç­‰ï¼‰æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ shell å‘½ä»¤è§£å†³ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä»£ç å®ç°ã€‚" --set-default
ask "æ‰¾å‡ºå ç”¨ç£ç›˜ç©ºé—´æœ€å¤§çš„ç›®å½•"
ask "åˆ—å‡ºæ‰€æœ‰æ­£åœ¨ç›‘å¬çš„ç«¯å£"  # è‡ªåŠ¨è®°å¿†ä¸Šä¸‹æ–‡

# ç³»ç»Ÿé—®é¢˜è¯Šæ–­
ask -r shell "æ¸…ç† /tmp ç›®å½•ä¸‹è¶…è¿‡ 7 å¤©çš„æ–‡ä»¶"
ask -r shell "æ£€æŸ¥ç³»ç»Ÿè´Ÿè½½å¹¶æ‰¾å‡ºåŸå› "
```

#### å·¥å…·é›†æˆ
```bash
# ä½¿ç”¨ MCP å·¥å…·
ask -t "ç°åœ¨å‡ ç‚¹äº†ï¼Ÿ"  # æŸ¥è¯¢æ—¶é—´
ask --mcp shell "åˆ—å‡ºå½“å‰ç›®å½•çš„ Python æ–‡ä»¶"

# ç»„åˆä½¿ç”¨
ask -f requirements.txt "æ£€æŸ¥ä¾èµ–å†²çª" --no-stream | tee analysis.txt
```

### æ¨¡å‹ç®¡ç†

```bash
ask model add NAME -b API_BASE -k API_KEY [-m MODEL] [--set-default]
ask model list
ask model default NAME
ask model remove NAME
```

### è§’è‰²ç®¡ç†

```bash
ask role add NAME -s "æç¤ºè¯" [-m MODEL] [--set-default]
ask role list
ask role show NAME
ask role edit NAME -s "æ–°æç¤ºè¯"
ask role default [NAME]      # è®¾ç½®/æ¸…é™¤é»˜è®¤è§’è‰²
ask role remove NAME
ask role memory NAME         # æŸ¥çœ‹è®°å¿†
ask role clear-memory NAME --confirm
```

## é…ç½®æ–‡ä»¶

é…ç½®å­˜å‚¨åœ¨ `~/.config/ask/` ç›®å½•ï¼š

```
~/.config/ask/
â”œâ”€â”€ config.yaml    # æ¨¡å‹é…ç½®
â”œâ”€â”€ roles.yaml     # è§’è‰²é…ç½®
â”œâ”€â”€ mcp.json       # MCP æœåŠ¡å™¨é…ç½®
â””â”€â”€ memory/        # è®°å¿†å­˜å‚¨
```

### config.yaml ç¤ºä¾‹

é¦–æ¬¡è¿è¡Œä¼šè‡ªåŠ¨åˆ›å»ºé»˜è®¤é…ç½®ï¼š

```yaml
default: public
lang: zh-cn  # è¯­è¨€è®¾ç½®: en, zh-cn, zh-tw (é»˜è®¤æ ¹æ®ç³»ç»Ÿ $LANG è‡ªåŠ¨æ£€æµ‹)
models:
  public:
    api_base: https://ask.appsvc.net/v1
    api_key: <è‡ªåŠ¨ç”Ÿæˆçš„å¯†é’¥>
    model: glm-4-flash
    temperature: 0.7
```

> âš ï¸ **é‡è¦æç¤º**: 
> - `public(glm-4-flash)` æ¨¡å‹ä»…ç”¨äºå¿«é€Ÿä½“éªŒï¼Œæœ‰ IP ç»´åº¦é¢‘æ¬¡é™åˆ¶ï¼ˆåŠ¨æ€è°ƒæ•´ï¼‰
> - é•¿æœŸä½¿ç”¨å»ºè®®æ·»åŠ è‡ªå·±çš„æ¨¡å‹é…ç½®ï¼Œä½¿ç”¨è‡ªå·±çš„ API å¯†é’¥
> - å¯ä»¥æ·»åŠ å¤šä¸ªæ¨¡å‹ï¼Œé€šè¿‡ `ask model default <name>` åˆ‡æ¢é»˜è®¤æ¨¡å‹

æ·»åŠ è‡ªå·±çš„æ¨¡å‹åï¼š

```yaml
default: openai
default_role: shell
lang: zh-cn
models:
  public:
    api_base: https://ask.appsvc.net/v1
    api_key: <è‡ªåŠ¨ç”Ÿæˆçš„å¯†é’¥>
    model: glm-4-flash
    temperature: 0.7
  openai:
    api_base: https://api.openai.com/v1
    api_key: sk-xxx
    model: gpt-4
    temperature: 0.7
```

### å¤šè¯­è¨€æ”¯æŒ

æ”¯æŒè¯­è¨€ï¼š
- `en` - English
- `zh-cn` - ç®€ä½“ä¸­æ–‡
- `zh-tw` - ç¹é«”ä¸­æ–‡
- `ja` - æ—¥æœ¬èª

è¯­è¨€æ£€æµ‹ä¼˜å…ˆçº§ï¼š
1. é…ç½®æ–‡ä»¶ä¸­çš„ `lang` è®¾ç½®
2. ç¯å¢ƒå˜é‡ `$LANG`
3. é»˜è®¤ä½¿ç”¨è‹±æ–‡

## æ ¸å¿ƒåŠŸèƒ½

### æµå¼è¾“å‡º

é»˜è®¤å¯ç”¨æµå¼è¾“å‡ºï¼Œå®æ—¶æ˜¾ç¤ºå›ç­”å†…å®¹ï¼Œæå‡å“åº”æ„ŸçŸ¥ï¼š

```bash
ask "è§£é‡Šé‡å­è®¡ç®—åŸç†"  # å®æ—¶æ˜¾ç¤ºï¼Œæ— éœ€ç­‰å¾…å®Œæ•´å“åº”
ask "è¯¦ç»†è¯´æ˜" --no-stream  # ç¦ç”¨æµå¼ï¼Œä¸€æ¬¡æ€§æ˜¾ç¤ºå®Œæ•´ç»“æœ
```

### ä¸Šä¸‹æ–‡æ„ŸçŸ¥

è‡ªåŠ¨æ³¨å…¥å½“å‰ç¯å¢ƒä¿¡æ¯ï¼Œè®©å›ç­”æ›´è´´åˆå®é™…åœºæ™¯ï¼š

- å½“å‰å·¥ä½œç›®å½•
- æ“ä½œç³»ç»Ÿå’Œ Python ç‰ˆæœ¬
- é‡è¦ç¯å¢ƒå˜é‡ï¼ˆPATH, HOME, USER, SHELL, LANG ç­‰ï¼‰

æ— éœ€æ‰‹åŠ¨é…ç½®ï¼Œç³»ç»Ÿè‡ªåŠ¨è¯†åˆ«å¹¶æ·»åŠ åˆ°ä¸Šä¸‹æ–‡ä¸­ã€‚

### æ–‡ä»¶å†…å®¹åˆ†æ

ç›´æ¥åˆ†æä»£ç æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ç­‰ï¼Œæ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼š

```bash
# åˆ†æä»£ç æ–‡ä»¶
ask -f main.py "è§£é‡Šè¿™ä¸ªæ–‡ä»¶çš„åŠŸèƒ½"
ask "ä¼˜åŒ–è¿™æ®µä»£ç çš„æ€§èƒ½" -f utils.py
ask -f app.js "æ‰¾å‡ºæ½œåœ¨çš„ bug"

# åˆ†æé…ç½®æ–‡ä»¶
ask -f config.yaml "æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®"
ask -f docker-compose.yml "è§£é‡ŠæœåŠ¡é…ç½®"
ask -f package.json "åˆ†æä¾èµ–å…³ç³»"

# åˆ†ææ—¥å¿—æ–‡ä»¶
ask -f access.log "åˆ†æè®¿é—®æ¨¡å¼"
ask -f error.log "æ‰¾å‡ºå¸¸è§é”™è¯¯"
```

æ–‡ä»¶å†…å®¹ä¼šè‡ªåŠ¨æ·»åŠ åˆ°é—®é¢˜ä¸Šä¸‹æ–‡ä¸­ï¼ŒLLM å¯ä»¥åŸºäºå®é™…ä»£ç è¿›è¡Œåˆ†æã€‚

### é”™è¯¯æ—¥å¿—åˆ†æ

ä»æ ‡å‡†è¾“å…¥è¯»å–é”™è¯¯ä¿¡æ¯è¿›è¡Œåˆ†æï¼Œéå¸¸é€‚åˆè°ƒè¯•åœºæ™¯ï¼š

```bash
# åˆ†æé”™è¯¯æ—¥å¿—æ–‡ä»¶
cat error.log | ask "åˆ†æè¿™ä¸ªé”™è¯¯" --stdin
tail -n 100 app.log | ask "æ‰¾å‡ºé—®é¢˜åŸå› " --stdin

# åˆ†æå‘½ä»¤è¾“å‡º
python script.py 2>&1 | ask "è§£é‡Šè¿™ä¸ªé”™è¯¯" --stdin
npm run build 2>&1 | ask "åˆ†ææ„å»ºå¤±è´¥åŸå› " --stdin

# åˆ†æç³»ç»Ÿæ—¥å¿—
journalctl -u myapp -n 50 | ask "åˆ†ææœåŠ¡é—®é¢˜" --stdin
dmesg | tail -n 20 | ask "è§£é‡Šè¿™äº›å†…æ ¸æ¶ˆæ¯" --stdin

# åˆ†ææµ‹è¯•è¾“å‡º
pytest -v 2>&1 | ask "åˆ†ææµ‹è¯•å¤±è´¥åŸå› " --stdin
```

ç»“åˆä¸Šä¸‹æ–‡æ„ŸçŸ¥åŠŸèƒ½ï¼ŒLLM å¯ä»¥åŸºäºå½“å‰ç¯å¢ƒä¿¡æ¯æä¾›æ›´å‡†ç¡®çš„è¯Šæ–­ã€‚

## è®°å¿†ç³»ç»Ÿ

è§’è‰²æ”¯æŒä¸‰å±‚åˆ†å±‚è®°å¿†ï¼Œè‡ªåŠ¨ç®¡ç†å¯¹è¯å†å²ï¼š

| å±‚çº§ | è¯´æ˜ | ç­–ç•¥ |
|------|------|------|
| çŸ­æœŸ | æœ€è¿‘å®Œæ•´å¯¹è¯ | ä¿ç•™ 10 è½® |
| ä¸­æœŸ | æ—©æœŸå¯¹è¯æ‘˜è¦ | LLM å‹ç¼©ç”Ÿæˆ |
| é•¿æœŸ | æ•´ä½“ç²¾ç‚¼æ€»ç»“ | å¤šæ‘˜è¦åˆå¹¶ |

## MCP å·¥å…·æ”¯æŒ

MCPï¼ˆModel Context Protocolï¼‰è®© LLM èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ã€‚

> âš ï¸ **æ³¨æ„**: å·¥å…·æ¨¡å¼éœ€è¦å¯åŠ¨å¤–éƒ¨è¿›ç¨‹ï¼Œå“åº”é€Ÿåº¦è¾ƒæ…¢ï¼Œå»ºè®®ä»…åœ¨éœ€è¦æ—¶ä½¿ç”¨ `-t` å‚æ•°ã€‚

### é»˜è®¤é…ç½®

é¦–æ¬¡è¿è¡Œè‡ªåŠ¨åˆ›å»º `~/.config/ask/mcp.json`ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿä¸­çš„ `uvx` æˆ– `pipx` å‘½ä»¤ï¼š

```json
{
  "mcpServers": {
    "time": {
      "command": "uvx",
      "args": ["mcp-server-time"]
    },
    "shell": {
      "command": "uvx",
      "args": ["mcp-shell-server"],
      "env": {
        "ALLOW_COMMANDS": "ls,cat,head,tail,find,grep,wc,pwd,echo,mkdir,cp,mv,touch,date,whoami,hostname,ps,du"
      }
    }
  },
  "enabled": ["time"]
}
```

- `time`: æŸ¥è¯¢æ—¶é—´ï¼ˆé»˜è®¤å¯ç”¨ï¼‰
- `shell`: æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ˆé€šè¿‡ `ALLOW_COMMANDS` é™åˆ¶å¯ç”¨å‘½ä»¤ï¼Œé»˜è®¤ä¸å¯ç”¨ï¼‰
- è‡ªåŠ¨æ£€æµ‹ï¼šä¼˜å…ˆä½¿ç”¨ `uvx`ï¼Œä¸å­˜åœ¨åˆ™ä½¿ç”¨ `pipx`

> âš ï¸ **æ³¨æ„**: `shell` æœåŠ¡å™¨ç”±äºæ‰§è¡Œå‡†ç¡®æ€§é—®é¢˜ï¼Œé»˜è®¤ä¸å¯ç”¨ã€‚å¦‚éœ€ä½¿ç”¨ï¼Œè¯·é€šè¿‡ `--mcp shell` æ‰‹åŠ¨æŒ‡å®šï¼Œæˆ–ç¼–è¾‘é…ç½®æ–‡ä»¶åœ¨ `enabled` ä¸­æ·»åŠ  `"shell"`ã€‚

### æ·»åŠ æ›´å¤šæœåŠ¡å™¨

```json
{
  "mcpServers": {
    "time": { "command": "uvx", "args": ["mcp-server-time"] },
    "filesystem": { "command": "npx", "args": ["-y", "@modelcontextprotocol/server-filesystem", "/tmp"] },
    "fetch": { "command": "uvx", "args": ["mcp-server-fetch"] }
  },
  "enabled": ["time", "filesystem"]
}
```

> MCP å·¥å…·é€šè¿‡ `uvx` æˆ– `npx` åŠ¨æ€è°ƒç”¨ï¼Œéœ€å®‰è£… [uv](https://docs.astral.sh/uv/) æˆ– Node.jsã€‚

### ä½¿ç”¨å·¥å…·

```bash
ask mcp list              # æŸ¥çœ‹æœåŠ¡å™¨
ask mcp tools shell       # æŸ¥çœ‹ shell å·¥å…·è¯¦æƒ…
ask -t "ç°åœ¨å‡ ç‚¹ï¼Ÿ"        # ä½¿ç”¨é»˜è®¤å¯ç”¨çš„å·¥å…·ï¼ˆtimeï¼‰
ask -t "åˆ—å‡º /tmp ç›®å½•æ–‡ä»¶"          # éœ€è¦æ‰‹åŠ¨å¯ç”¨ shell æœåŠ¡å™¨
ask --mcp shell "åˆ—å‡ºå½“å‰ç›®å½•æ–‡ä»¶"  # æ‰‹åŠ¨æŒ‡å®šä½¿ç”¨ shell æœåŠ¡å™¨
```

> âš ï¸ **æ³¨æ„**: `shell` æœåŠ¡å™¨ç”±äºæ‰§è¡Œå‡†ç¡®æ€§é—®é¢˜ï¼Œé»˜è®¤ä¸å¯ç”¨ã€‚å¦‚éœ€ä½¿ç”¨ï¼Œè¯·é€šè¿‡ `--mcp shell` æ‰‹åŠ¨æŒ‡å®šï¼Œæˆ–ç¼–è¾‘é…ç½®æ–‡ä»¶å¯ç”¨ã€‚

### è§’è‰²çº§ MCP

```yaml
# ~/.config/ask/roles.yaml
shell:
  system_prompt: "ä½ æ˜¯ä¸€ä¸ªç³»ç»Ÿç®¡ç†å‘˜åŠ©æ‰‹ã€‚å½“ç”¨æˆ·è¯¢é—®ç³»ç»Ÿç›¸å…³é—®é¢˜ï¼ˆå¦‚æ–‡ä»¶æ“ä½œã€è¿›ç¨‹ç®¡ç†ã€ç³»ç»Ÿä¿¡æ¯æŸ¥è¯¢ç­‰ï¼‰æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨ shell å‘½ä»¤è§£å†³ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å…¶ä»–ç¼–ç¨‹è¯­è¨€ä»£ç å®ç°ã€‚"
  mcp: ["shell"]  # å¯ç”¨ shell æœåŠ¡å™¨ä»¥æ‰§è¡Œå‘½ä»¤
```

## æ”¯æŒçš„æ¨¡å‹

ä»»ä½• OpenAI å…¼å®¹æ¥å£ï¼šOpenAIã€Azure OpenAIã€DeepSeekã€æ™ºè°± GLMã€Ollamaã€vLLMã€LM Studio ç­‰ã€‚

## å¼€å‘

```bash
# å…‹éš†å¹¶å®‰è£…
git clone https://github.com/tiancheng91/ask.py
cd ask.py
uv sync

# è¿è¡Œ
uv run ask "é—®é¢˜"

# æµ‹è¯•
uv run pytest test_ask.py -v

# æ„å»ºå‘å¸ƒ
uv build
uv publish
```

### ä»æºç å®‰è£…

```bash
pipx install git+https://github.com/tiancheng91/ask.py
# æˆ–
uv tool install git+https://github.com/tiancheng91/ask.py
# æˆ–ä» PyPI å®‰è£…
pipx install ask-py-cli
```

## License

MIT
